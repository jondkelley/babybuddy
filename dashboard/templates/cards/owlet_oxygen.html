{% extends 'cards/base.html' %}
{% load duration i18n %}
{% block header %}
    <a href="{% url "owlet:settings-list" %}">{% trans "Owlet Oxygen" %}</a>
{% endblock %}
{% block title %}
    {% if reading %}
        {% if stale %}
            <style>
                @keyframes stale-blink {
                    0%, 49% { opacity: 1; }
                    50%, 99% { opacity: 0.3; }
                }
                .stale-indicator {
                    animation: stale-blink 2s infinite;
                }
            </style>
            <div class="text-danger stale-indicator">
                <strong>{% trans "STALE" %}</strong>
            </div>
        {% endif %}
    {% else %}
        {% trans "No readings yet" %}
    {% endif %}
{% endblock %}
{% block content %}
    {% if reading %}
        <div class="text-center {% if alert %}owlet-alert-blink{% endif %}" style="padding: 20px;">
            <div style="font-size: 3rem; font-weight: bold; {% if alert %}color: #dc3545;{% endif %}">
                <i class="icon-lungs" aria-hidden="true"></i>
                {% if reading.oxygen_saturation_pct %}
                    {{ reading.oxygen_saturation_pct|floatformat:0 }}%
                {% else %}
                    --%
                {% endif %}
            </div>
            <div style="font-size: 1.2rem; margin-top: 10px;">
                <strong>{% trans "Oxygen Saturation" %}</strong>
            </div>
            {% if alert %}
                <div style="margin-top: 10px; font-size: 0.9rem; color: #dc3545;">
                    <strong>⚠️ {% trans "CRITICAL: Below 90%" %}</strong>
                </div>
            {% endif %}
        </div>
    {% else %}
        <p class="text-muted">{% trans "No Owlet device configured for this child." %}</p>
    {% endif %}
{% endblock %}
