{% extends 'cards/base.html' %}
{% load duration i18n %}
{% block header %}
    <a href="{% url "owlet:settings-list" %}">{% trans "Owlet Consciousness" %}</a>
{% endblock %}
{% block title %}
    {% if reading %}
        {% if stale %}
            <style>
                @keyframes stale-blink {
                    0%, 49% { opacity: 1; }
                    50%, 99% { opacity: 0.3; }
                }
                .stale-indicator {
                    animation: stale-blink 2s infinite;
                }
            </style>
            <div class="text-danger stale-indicator">
                <strong>{% trans "STALE" %}</strong>
            </div>
        {% endif %}
    {% else %}
        {% trans "No readings yet" %}
    {% endif %}
{% endblock %}
{% block content %}
    {% if reading %}
        <div class="text-center" style="padding: 20px;">
            {% if is_awake is not None %}
                {% if is_awake %}
                    <div style="font-size: 3rem; font-weight: bold; color: #ffc107;">
                        <i class="icon-eye" aria-hidden="true"></i>
                    </div>
                    <div style="font-size: 1.5rem; margin-top: 10px; font-weight: bold; color: #ffc107;">
                        {% trans "Awake" %}
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9rem;" class="text-muted">
                        {% trans "Movement detected above baseline" %}
                    </div>
                {% else %}
                    <div style="font-size: 3rem; font-weight: bold; color: #6c757d;">
                        <i class="icon-moon" aria-hidden="true"></i>
                    </div>
                    <div style="font-size: 1.5rem; margin-top: 10px; font-weight: bold; color: #6c757d;">
                        {% trans "Asleep" %}
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9rem;" class="text-muted">
                        {% trans "Movement at or below baseline" %}
                    </div>
                {% endif %}
            {% else %}
                <div style="font-size: 3rem; font-weight: bold; color: #6c757d;">
                    <i class="icon-help-circle" aria-hidden="true"></i>
                </div>
                <div style="font-size: 1.2rem; margin-top: 10px;" class="text-muted">
                    {% trans "Unknown" %}
                </div>
                <div style="margin-top: 10px; font-size: 0.9rem;" class="text-muted">
                    {% trans "Insufficient movement data" %}
                </div>
            {% endif %}
            {% if reading.movement_value is not None or reading.battery_pct %}
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                    <div class="row">
                        {% if reading.movement_value is not None %}
                            <div class="col-4">
                                <small class="text-muted">{% trans "Movement" %}</small><br>
                                <strong>{{ reading.movement_value }}</strong>
                            </div>
                            <div class="col-4">
                                <small class="text-muted">{% trans "Baseline" %}</small><br>
                                <strong>{{ reading.movement_baseline|default:"--" }}</strong>
                            </div>
                        {% endif %}
                        {% if reading.battery_pct %}
                            <div class="col-4">
                                <small class="text-muted"><i class="icon-battery" aria-hidden="true"></i> {% trans "Battery" %}</small><br>
                                <strong>{{ reading.battery_pct|floatformat:0 }}%</strong>
                            </div>
                        {% endif %}
                    </div>
                </div>
            {% endif %}
        </div>
    {% else %}
        <p class="text-muted">{% trans "No Owlet device configured for this child." %}</p>
    {% endif %}
{% endblock %}
